<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meeting Room Booking</title>
</head>
<body>
    <h1>Meeting Room Booking</h1>
    <form id="bookingForm">
        <label for="city">City:</label>
        <input type="text" id="city" name="city" required>
        <br>
        <label for="participants">Participants:</label>
        <input type="number" id="participants" name="participants" required>
        <br>
        <button type="submit">Submit</button>
    </form>

    <div id="result"></div>
    <div id="logs"></div>

    <script>
        document.getElementById('bookingForm').addEventListener('submit', function (event) {
            event.preventDefault();

            var city = document.getElementById('city').value;
            var participants = document.getElementById('participants').value;

            var request = {
                city: city,
                participants: parseInt(participants)
            };

            fetch('/api/room', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(request)
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok ' + response.statusText);
                    }
                    return response.json().catch(() => { throw new Error('Invalid JSON response') });
                })
                .then(data => {
                    console.log(data); // Debug: Gelen yanıtı kontrol etmek için

                    var resultDiv = document.getElementById('result');
                    if (Array.isArray(data.availableRooms)) {
                        resultDiv.innerHTML = '<h2>Available Rooms:</h2><ul>' + data.availableRooms.map(room => '<li>' + room.roomName + ' in ' + room.city + '</li>').join('') + '</ul>';
                    } else {
                        resultDiv.innerHTML = '<p>' + data.message + '</p>';
                    }

                    var logsDiv = document.getElementById('logs');
                    if (Array.isArray(data.logs)) {
                        logsDiv.innerHTML = '<h2>Handler Logs:</h2><ul>' + data.logs.map(log => '<li>' + log + '</li>').join('') + '</ul>';
                    } else {
                        logsDiv.innerHTML = '<p>No logs found.</p>';
                    }
                })
                .catch(error => {
                    console.error(error); // Debug: Hata mesajını kontrol etmek için

                    var resultDiv = document.getElementById('result');
                    resultDiv.innerHTML = '<p>Error: ' + error.message + '</p>';

                    var logsDiv = document.getElementById('logs');
                    logsDiv.innerHTML = '<p>Error fetching logs: ' + error.message + '</p>';
                });
        });
    </script>
</body>
</html>
